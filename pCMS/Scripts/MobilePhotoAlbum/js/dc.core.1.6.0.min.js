/* 
 * Digicrafts JS Framework
 * @version 1.0.0
 * Copyright (c) 2011 DIGICRAFTS. All Right Reserved.
 * 
 * http://www.digicrafts.com.hk/components
 * 
 *  This software is the proprietary information of
 *  DIGICRAFTS. ("Proprietary Information").  You shall not
 *  disclose such Proprietary Information and shall use it only in
 *  accordance with the terms of the license agreement you entered into
 *  with DIGICRAFTS. 
 * 
 * 
 */
(function($){window.DC=window.DC||{};window.DC.NOOP=function(){};var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,prop[name]):prop[name];}function Class(){if(!initializing&&this.init){this.init.apply(this,arguments);}}Class.prototype=prototype;Class.constructor=Class;Class.extend=arguments.callee;return Class;};var Interface={_currentTarget:null,init:function(options){if(options&&options.delegate){this.setDelegate(options.delegate);}},setDelegate:function(delegate){if(delegate){var self=this;var fn;if(this.delegate){for(fn in this){if(typeof this[fn]=="function"&&fn.substring(0,1)=="I"&&this.delegate[fn.substring(1,fn.length)]){delete this.delegate[fn.substring(1,fn.length)];}}}for(fn in this){if(typeof this[fn]=="function"){if(fn.substring(0,1)=="I"){var f=function(){self[arguments.callee.FUNCTION_NAME].apply(self,arguments);};f["FUNCTION_NAME"]=fn;delegate[fn.substring(1,fn.length)]=f;}}else{}}this.delegate=delegate;}}};window.Interface=Class.extend(Interface);DC.synthesize=function(prop,target){if(target[prop]!=undefined){var s="set"+prop.charAt(0).toUpperCase()+prop.slice(1);target[s]=function(value){if((this.commitProperties&&this[prop]!=value)){this[prop]=value;this.commitProperties(prop,value);}};target[s].call(target,target[prop]);}};var Error={id:0,msg:"",init:function(id,msg){this.id=id;this.msg=msg;},toString:function(){return"[Error (id="+this.id+" msg="+this.msg+")]";}};window.DC.Error=Class.extend(Error);})(jQuery);(function($){var Debug={_console:null,log:function(){if(Debug.debug&&!DC.System.isOpera&&!DC.System.isIE){var msg="";if(arguments){if(arguments.length>1){for(var i=0;i<arguments.length;i++){msg+=arguments[i]+" ";}}else{msg=arguments[0];}}window.console.log(msg);if(Debug.inline){$("#debug_console").append("<div>"+msg+"</div><br/>");}}},debug:false};DC.Debug=Debug;window.log=DC.log=Debug.log;})(jQuery);(function($){DC.num=function(value){return parseInt(value,10)||0;};DC.roundNumber=function(num,dec){var result=Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);return result;};DC.hexToRGB=function(hex){var rgb={r:0,g:0,b:0};hex=(hex.charAt(0)=="#")?hex.substring(1,7):hex;rgb.r=parseInt(hex.substring(0,2),16);rgb.g=parseInt(hex.substring(2,4),16);rgb.b=parseInt(hex.substring(4,6),16);return rgb;};DC.getIETransparentColor=function(hex,alpha){hex=(hex.charAt(0)=="#")?hex.substring(1,7):hex;hex="#"+String(alpha).toString(16)+hex;return"progid:DXImageTransform.Microsoft.gradient(startColorstr="+hex+",endColorstr="+hex+")";};DC.System={isIPhone:false,isIPad:false,isAndroid:false,isIOS:false,isTouch:false,isIE:false,isFirefox:false,isOpera:false,isSafari:false,isChrome:false};DC.System.isIPhone=RegExp("iPhone").test(navigator.userAgent);DC.System.isIPad=RegExp("iPad").test(navigator.userAgent);DC.System.isIOS=DC.System.isIPad||DC.System.isIPhone;DC.System.isAndroid=RegExp("Android").test(navigator.userAgent);DC.System.isTouch=DC.System.isIOS||DC.System.isAndroid;DC.System.isIE=RegExp("MSIE").test(navigator.userAgent);DC.System.isFirefox=RegExp("Gecko").test(navigator.userAgent);DC.System.isOpera=RegExp("Opera").test(navigator.userAgent);DC.System.isSafari=RegExp("Safari").test(navigator.userAgent);DC.System.isChrome=RegExp("Chrome").test(navigator.userAgent);DC.System.isOldIE=$.browser.msie&&(Number($.browser.version)<9);DC.Alignment={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3,MIDDLE:4,CENTER:5,TOP_LEFT:10,TOP_RIGHT:11,BOTTOM_LEFT:10,BOTTOM_RIGHT:11,VERTICAL:50,HORIZONTAL:51,AUTO:99,HIDE:100};DC.Size={AUTO:0,AUTO_WIDTH:1,AUTO_HEIGHT:2,STRETCH:3,CLIP:4,AUTO_FILL:5,NONE:999,getSize:function(width,height,constraintW,constraintH,mode,alignment){if(mode==undefined){mode=this.AUTO_FILL;}var w=width;var h=height;if(mode==this.STRETCH){w=constraintW;h=constraintH;}else{if(mode==this.AUTO_WIDTH){w=constraintW;h=height*constraintW/width;}else{if(mode==this.AUTO_HEIGHT){h=constraintH;w=width*constraintH/height;}else{if(mode==this.AUTO){if(constraintH>constraintW){if(width<height){h=constraintH;w=width*constraintH/height;if(w>constraintW){w=constraintW;h=height*constraintW/width;}}else{w=constraintW;h=height*constraintW/width;if(h>constraintH){h=constraintH;w=width*constraintH/height;}}}else{if(width>height){w=constraintW;h=height*constraintW/width;if(h>constraintH){h=constraintH;w=width*constraintH/height;}}else{h=constraintH;w=width*constraintH/height;if(w>constraintW){w=constraintW;h=height*constraintW/width;}}}}else{if(mode==this.AUTO_FILL){if(constraintH>constraintW){h=constraintH;w=width*constraintH/height;if(w<constraintW){w=constraintW;h=height*constraintW/width;}}else{w=constraintW;h=height*constraintW/width;if(h<constraintH){h=constraintH;w=width*constraintH/height;}}}}}}}var tx=(constraintW-w)/2;var ty=(constraintH-h)/2;switch(alignment){case DC.Alignment.LEFT:tx=0;break;case DC.Alignment.RIGHT:tx=constraintW-w;break;case DC.Alignment.TOP:ty=0;break;case DC.Alignment.BOTTOM:ty=(constraintH-h);break;}return{width:w,height:h,tx:tx,ty:ty};}};DC.HCI={DEFAULT_EVENT:function(e){e.preventDefault();},disableDrag:function(){$("body").bind("dragstart",this.DEFAULT_EVENT);},enableDrag:function(){$("body").unbind("dragstart",this.DEFAULT_EVENT);},disableTouch:function(){document.ontouchmove=this.DEFAULT_EVENT;},enableTouch:function(){document.ontouchmove=null;}};})(jQuery);(function($){var SlideshowManager={"duration":2,"timer":null,"uitarget":null,"isIdeal":true,"enabled":true,onChange:function(){},start:function(){if(this.isIdeal&&this.enabled){var self=this;self.isIdeal=false;dc.log(">>>>>> START SLIDE SHOW <<<<<<<<");if(self.uitarget){self.uitarget.addClass("slideshow_pause");}self.timer=setInterval(function(){self.onChange();},self.duration*1000);}},stop:function(reset){dc.log(">>>>>> STOP SLIDE SHOW <<<<<<<<");this.isIdeal=true;if(this.uitarget){this.uitarget.removeClass("slideshow_pause");}if(this.timer){clearInterval(this.timer);}},restart:function(reset){this.stop();this.start();},toggle:function(){if(this.isIdeal){this.start();}else{this.stop();}},init:function(options){if(options){$.extend(this,options);}}};DC.SlideshowManager=Class.extend(SlideshowManager);})(jQuery);(function($){DC.Event={type:"event",target:null,init:function(type,target){this.type=type;this.target=target;},clone:function(){return new Event(this.type,this.target);},toString:function(){return"[Event (type="+this.type+")]";}};DC.Event=Class.extend(DC.Event);DC.EventDispatcher={_listener:null,init:function(options){this._listener=[];this._super(options);},IdispatchEvent:function(e){if(e&&this._listener[e.type]){for(var i in this._listener[e.type]){this._listener[e.type][i].call(e.target,e);}}},IaddEventListener:function(type,f){this._listener[type]=this._listener[type]||[];this._listener[type].push(f);},IremoveEventListener:function(type,f){if(f&&this._listener[type]){for(var i in this._listener[type]){if(this._listener[type][i]==f){this._listener[type].splice(i,0);}}}else{this._listener[type]=null;delete this._listener[type];}}};DC.EventDispatcher=Interface.extend(DC.EventDispatcher);DC.ErrorEvent={error:null,init:function(type,error){this._super(type);this.error=error;}};DC.ErrorEvent=DC.Event.extend(DC.ErrorEvent);
$.extend(DC.ErrorEvent,{ERROR:"error"});})(jQuery);(function($){var XMLParser={parse:null};DC.XMLParser=Class.extend(XMLParser);var DCXMLParser={parse:function(xml,options){if($(xml).find("items").size()>0){var result=[];$(xml).find("item").each(function(){var node=$(this);var item={};item["source"]=options.imagePath+node.attr("source");item["thumbnail"]=options.imagePath+node.attr("thumbnail");item["category"]=node.attr("category");$(this).children().each(function(){item[this.nodeName]=$(this).text();});result.push(item);});return result;}return null;}};DC.DCXMLParser=DC.XMLParser.extend(DCXMLParser);var LRXMLParser={parse:function(xml,options){log("DC.DataSource.relativePath",DC.DataSource.relativePath);var basePath=(DC.DataSource.relativePath)?options.imagePath:"";if($(xml).find("mediaGroup").size()>0){var result=[];$(xml).find("item").each(function(){var item={};if(DC.System.isIE){if($(this).find("description").get(0)){item.description=$(this).find("description").get(0).text;}if($(this).find("title").get(0)){item.title=$(this).find("title").get(0).text;}if($(this).find("category").get(0)){item.category=$(this).find("category").get(0).text;}}else{if($(this).find("description").get(0)){item.description=$(this).find("description").get(0).textContent;}if($(this).find("title").get(0)){item.title=$(this).find("title").get(0).textContent;}if($(this).find("category").get(0)){item.category=$(this).find("category").get(0).textContent;}}$(this).find("rendition").each(function(){var node=$(this);var size=node.attr("size");var source=node.attr("src");var w=node.attr("width");var h=node.attr("height");switch(size){case"small":item.smallSource=basePath+source;item.smallWidth=w;item.smallHeight=h;break;case"medium":item.mediumSource=basePath+source;item.mediumWidth=w;item.mediumHeight=h;break;case"large":item.largeSource=basePath+source;item.largeWidth=w;item.largeHeight=h;break;default:item.thumbSource=basePath+source;item.thumbWidth=w;item.thumbHeight=h;break;}item.thumbnail=item.thumbSource;item.source=item.largeSource;item.width=w;item.height=h;});result.push(item);});return result;}return null;}};DC.LRXMLParser=DC.XMLParser.extend(LRXMLParser);var PSXMLParser={parse:function(xml,options){if($(xml).find("gallery").size()>0){var result=[];var thumbpath=imagePath+$(xml).find("thumbnail").attr("base");var largepath=imagePath+$(xml).find("large").attr("base");$(xml).find("image").each(function(){var item={};var node=$(this);item.thumbnail=thumbpath+node.attr("thumbnpath");item.source=largepath+node.attr("path");item.width=node.attr("width");item.height=node.attr("height");result.push(item);});return result;}return null;}};DC.PSXMLParser=DC.XMLParser.extend(PSXMLParser);})(jQuery);(function($){DC.DataSourceEvent={index:-1,data:null,init:function(type,data,index){this._super(type);this.data=data;if(index!=undefined){this.index=index;}}};window.DC.DataSourceEvent=DC.Event.extend(DC.DataSourceEvent);$.extend(DC.DataSourceEvent,{COMPLETE:"datasource_complete",UPDATE:"datasource_update",DATA_READY:"data_ready",DATA_ADD:"data_add",DATA_REMOVE:"data_remove"});DC.DataSource={source:null,relativepath:true,data:null,loaded:false,onError:DC.NOOP,onComplete:DC.NOOP,onUpdate:DC.NOOP,onDataReady:DC.NOOP,init:function(options){$.extend(this,options);if(this.source){this.load(this.source);}},processData:function(){},handleDataLoadComplete:function(data){this.data=data;this.loaded=true;this.onComplete(new DC.DataSourceEvent(DC.DataSourceEvent.COMPLETE,data));},length:function(){if(this.data){return this.data.length;}return 0;},getItemAt:function(index){return this.data?this.data[index]:null;},addItem:function(data){if(this.data){this.addItemAt(data,this.data.length);}},addItemAt:function(data,index){if(this.data){if(index>=this.data.length){this.data.push(data);}else{this.data.splice(index,0,data);index=this.data.length-1;}this.onDataUpdate(new DC.DataSourceEvent(DC.DataSourceEvent.DATA_ADD,data,index));}},removeItem:function(data){for(var i in this.data){if(this.data[i]==data){this.removeItemAt(i);}}},removeItemAt:function(index){if(this.data&&index>=0){if(index>=this.data.length){this.data.pop();}else{this.data.splice(index,1);}this.onDataUpdate(new DC.DataSourceEvent(DC.DataSourceEvent.DATA_REMOVE,this.data,index));}},load:function(src){this.loaded=false;if(src){if((src.constructor.toString().indexOf("Array")!=-1)){this.handleDataLoadComplete(src);}}}};window.DC.DataSource=Class.extend(DC.DataSource);$.extend(DC.DataSource,{relativePath:true});})(jQuery);(function($){var XMLDataSource={parsers:[DC.DCXMLParser,DC.LRXMLParser,DC.PSXMLParser],parse:function(xml){var result=[];var imagePathArray;var imagePath="";if(this.relativepath==true){imagePathArray=this.source.split("/");imagePathArray.pop();if(imagePathArray.length>0){imagePath=imagePathArray.join("/")+"/";}}var options={imagePath:imagePath};for(idx in this.parsers){var parser=new this.parsers[idx];result=parser.parse(xml,options);if(result){break;}}return result;},load:function(src){this._super(src);var self=this;self.source=src;if(src!=""&&src!=undefined){if($.isArray(src)||$.isPlainObject(src)){}else{if(false){var xdr=false;if(!xdr){try{xdr=new ActiveXObject("MSXML2.XMLHTTP");}catch(e){xdr=false;}}if(!xdr){try{xdr=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){xdr=false;}}if(!xdr&&window.XDomainRequest){try{xdr=new XDomainRequest();}catch(e){xdr=false;}}xdr.open("get",src);xdr.onreadystatechange=function(){this.onreadystatechange=null;if(xdr.readyState==4){var dom=new ActiveXObject("Microsoft.XMLDOM");dom.async=false;dom.loadXML(xdr.responseText);var results=self.parse(dom);self.handleDataLoadComplete(results);}};xdr.send();}else{if(window.location.protocol=="agwpg:"||window.location.protocol=="file:"){$.ajaxSetup({isLocal:true});}$.ajax({url:src,dataType:($.browser.msie)?"text":"xml",success:function(data){this.success=null;var xml;if(typeof data=="string"){xml=new ActiveXObject("Microsoft.XMLDOM");xml.async=false;xml.loadXML(data);}else{xml=data;}var results=self.parse(xml);self.handleDataLoadComplete(results);},error:function(xhr,textStatus,errorThrown){log("AJAX Error:",textStatus,errorThrown);}});}}}}};DC.XMLDataSource=DC.DataSource.extend(XMLDataSource);})(jQuery);(function($){DC.Storage={id:"DEFAULT_STORAGE",version:"1.0",data:null,lastupdate:0,onUpdate:DC.NOOP,init:function(options){if(options){$.extend(this,options);}this.createStorage();},createStorage:function(){},saveStorage:function(){this.onUpdate(this);},set:function(key,data){this.data[key]=data;this.saveStorage();},clean:function(key){delete this.data[key];this.data[key]=null;this.saveStorage();},get:function(key){return this.data[key];}};window.DC.Storage=Class.extend(DC.Storage);DC.CookieStorage={_getCookie:function(name){if(document.cookie.length>0){var start=document.cookie.indexOf(name+"=");if(start!=-1){start=start+name.length+1;var end=document.cookie.indexOf(";",start);if(end==-1){end=document.cookie.length;}return unescape(document.cookie.substring(start,end));}}return"";},_setCookie:function(name,value,expiredays){var exdate=new Date();exdate.setDate(exdate.getDate()+expiredays);document.cookie=name+"="+escape(value)+((expiredays==null)?"":";expires="+exdate.toUTCString());},createStorage:function(){var storage=this._getCookie(this.id);if(storage!=null&&storage!=""){this.data=window.JSON.parse(storage);if(this.data.version==undefined||this.data.version==null||this.data.version!=this.version){this.data={"version":this.version};}}else{this.data={"version":this.version};}this._super();},saveStorage:function(){var storage=JSON.stringify(this.data);this._setCookie(this.id,storage,1000);this._super();}};window.DC.CookieStorage=DC.Storage.extend(DC.CookieStorage);})(jQuery);(function($){DC.easing={linear:"linear",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",easeInQuad:"ease-in",easeOutQuad:"ease-out",easeInOutQuad:"ease-in-out",easeInCubic:"ease-in",easeOutCubic:"ease-out",easeInOutCubic:"ease-in-out",easeInQuart:"ease-in",easeOutQuart:"ease-out",easeInOutQuart:"ease-in-out",easeInQuint:"ease-in",easeOutQuint:"ease-out",easeInOutQuint:"ease-in-out",easeInSine:"ease-in",easeOutSine:"ease-out",easeInOutSine:"ease-in-out",easeInExpo:"ease-in",easeOutExpo:"ease-out",easeInOutExpo:"ease-in-out",easeInCirc:"ease-in",easeOutCirc:"ease-out",easeInOutCirc:"ease-in-out",easeInElastic:"ease-in",easeOutElastic:"ease-out",easeInOutElastic:"ease-in-out",easeInBack:"ease-in",easeOutBack:"cubic-bezier(0, 1, 1, 1)",easeInOutBack:"ease-in-out",easeInBounce:"ease-in",easeOutBounce:"ease-out",easeInOutBounce:"ease-in-out"};
DC.transform={enabled:false,transitionEventType:"webkitTransitionEnd",deg2radians:Math.PI*2/360,getRotationTransform:function(deg,scale){rad=deg*this.deg2radians;costheta=Math.cos(rad);sintheta=Math.sin(rad);a=parseFloat(costheta).toFixed(8)*scale;c=parseFloat(-sintheta).toFixed(8);b=parseFloat(sintheta).toFixed(8);d=parseFloat(costheta).toFixed(8)*scale;return"progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+b+", M21="+c+", M22="+d+",sizingMethod='auto expand')";},setTransform:function(target,x,y,t,ease,s,f,r){if(r==undefined){r=0;}if(t==undefined||t==0){t="";}else{t=t+"s";DC.transform._addTransitionEvents(target,f);}DC.transform._setTransform(target,x,y,t,ease,s,f,r);},_ie_setTransform:function(target,x,y,t,ease,s,f,r){r=(r==undefined)?0:r;var pos={left:x,top:y};if(target.parent&&target.parent._paddingB){pos.left+=target.parent._paddingB.left;pos.top+=target.parent._paddingB.top;}if(t==null||t==undefined||t==undefined){t=0;}if(t>=0.02){t=t*1000;ease="linear";target.ui.animate(pos,t,ease,f);}else{if(r!=0&&s!=1){pos["-ms-filter"]=pos["filter"]=this.getRotationTransform(r,s);}target.ui.css(pos);}},_safari_setTransform:function(target,x,y,t,ease,s,f,r){target.ui.css({"-webkit-transform-origin":"0 0","-webkit-transition-property":"-webkit-transform","-webkit-transition-timing-function":undefined,"-webkit-transition-duration":t,"-webkit-transform":"translate3d("+x+"px,"+y+"px,0) scale("+s+") rotateZ("+r+"deg)"});},_android_setTransform:function(target,x,y,t,ease,s,f,r){target.ui.css({"-webkit-transform-origin":"0 0","-webkit-transition-property":"-webkit-transform","-webkit-transition-timing-function":undefined,"-webkit-transition-duration":t,"-webkit-transform":"translate("+x+"px,"+y+"px) scale("+s+") rotate("+r+"deg)"});},_moz_setTransform:function(target,x,y,t,ease,s,f,r){target.ui.css({"-moz-transform-origin":"0 0","-moz-transition-property":"-moz-transform","-moz-transition-duration":t,"-moz-transform":"translate("+x+"px,"+y+"px) scale("+s+") rotate("+r+"deg)"});},_o_setTransform:function(target,x,y,t,ease,s,f,r){target.ui.css({"-o-transform-origin":"0 0","-o-transition-property":"-o-transform","-o-transition-timing-function":undefined,"-o-transition-duration":t,"-o-transform":"translate("+x+"px,"+y+"px) scale("+s+") rotate("+r+"deg)"});},_addTransitionEvents:function(target,f){if(f){target.ui.bind(DC.transform.transitionEventType,function(){target.ui.unbind(DC.transform.transitionEventType);f();});}}};if($.browser.webkit){DC.transform.transitionEventType="webkitTransitionEnd";if(DC.System.isAndroid){DC.transform.enabled=true;DC.transform._setTransform=DC.transform._android_setTransform;}else{DC.transform.enabled=true;DC.transform._setTransform=DC.transform._safari_setTransform;}}else{if($.browser.mozilla){DC.transform.transitionEventType="transitionend";DC.transform.enabled=true;DC.transform._setTransform=DC.transform._moz_setTransform;}else{if($.browser.opera){DC.transform.transitionEventType="oTransitionEnd";DC.transform.enabled=true;DC.transform._setTransform=DC.transform._o_setTransform;}else{DC.transform.setTransform=DC.transform._ie_setTransform;}}}})(jQuery);(function($){var ListEvent={index:-1,data:null,init:function(type,target,data,index){this._super(type,target);this.data=data;this.index=index;}};DC.ListEvent=DC.Event.extend(ListEvent);$.extend(DC.ListEvent,{SELECT:"list_item_select",CLICK:"list_item_click",DOUBLE_CLICK:"list_item_doubleclick",DOWN:"list_item_down",UP:"list_item_up",OVER:"list_item_over",OUT:"list_item_out"});DC.ListController={name:"ListController",datasource:null,itemRenderer:null,allowMultipleSelection:false,selectable:true,selectedDataIndex:-1,selectedData:null,_items:null,_pool:null,onDataSelected:DC.NOOP,onDataDeselected:DC.NOOP,init:function(options){$.extend(this,options);this._super(options);this._items=[];this._pool=[];new DC.EventDispatcher({delegate:this.delegate});if(this.datasource){this.IsetDataSource(this.datasource);}},handleDataSourceComplete:function(e){this._build(this.datasource);this._setSelectedDataIndex(this.selectedDataIndex);},_build:function(ds){this._items=[];for(var i=0;i<this.datasource.data.length;i++){this._items.push({index:i,data:this.datasource.data[i],onDataSelected:DC.NOOP,onDataDeselected:DC.NOOP});}if(this.delegate&&this.delegate.build){this.delegate.build(this.datasource);}},getItem:function(index){return this._items[index];},destroy:function(){},length:function(){if(this.datasource){return this.datasource.length();}return 0;},_setSelectedDataIndex:function(index){if(this.selectable){if(index==undefined||index<0||index==null){if(this.selectedData){this.selectedData.onDeselected();}this.delegate.onDataDeselected(this.selectedData);this.selectedData=null;this.selectedDataIndex=-1;}else{if(this.selectedData){this.selectedData.onDeselected();this.delegate.onDataDeselected(this.selectedData);}this.selectedData=this.getItem(index);this.selectedDataIndex=index;if(this.selectedData){this.delegate.onDataSelected(this.selectedData);this.selectedData.onSelected();}}}},_setSelectable:function(value){this.selectable=value;},IsetDataSource:function(ds){if(ds){var self=this;self.delegate.datasource=this.datasource=ds;ds.onDataUpdate=function(e){if(self.delegate!=undefined){if(e.type==DC.DataSourceEvent.DATA_ADD){if(self.delegate.handleDataSourceAdd!=undefined){self.delegate.handleDataSourceAdd(e);}}else{if(e.type==DC.DataSourceEvent.DATA_REMOVE){if(self.delegate.handleDataSourceRemove!=undefined){self.delegate.handleDataSourceRemove(e);}}}}};if(ds.loaded){self.handleDataSourceComplete(null);}else{ds.onComplete=function(e){self.handleDataSourceComplete(e);};}}},IsetSelectedDataIndex:function(index){var self=this;self._setSelectedDataIndex(index);},IsetSelectable:function(value){var self=this;self._setSelectable(value);}};DC.ListController=Interface.extend(DC.ListController);})(jQuery);(function($){DC.ScrollController={verticalScrollPolicy:"auto",horizontalScrollPolicy:"auto",verticalScrollPosition:0,horizontalScrollPosition:0,maxVerticalScrollPosition:0,maxHorizontalScrollPosition:0,minVerticalScrollPosition:0,momentumEnabled:true,showScrollBar:"off",snap:null,bound:false,scale:1,minScale:1,maxScale:1,allowScale:false,allowScroll:false,minHorizontalScrollPosition:0,boundEnabled:true,lockScroll:false,contentAlign:DC.Alignment.CENTER,isGesture:false,isLastGesture:false,isMove:false,isMouseDown:false,isOver:false,isInScroll:false,_eventsReady:false,_hscroll:"auto",_vscroll:"auto",_hscrollbar:null,_vscrollbar:null,_containerWidth:0,_containerHeight:0,_contentWidth:0,_contentHeight:0,_last:null,_speed:null,_lastPointerPosition:null,_lastPointerMiddlePosition:null,_lastOffsetPosition:null,_tempOffsetPosition:null,_currentOffsetPosition:null,_targetOffsetPosition:null,_numberOfTouch:0,_isEndScroll:false,_scrollbarScroll:false,_lastScrollPosiiton:0,_timer:-1,_endScrollTimer:-1,onScroll:DC.NOOP,onScrollStart:DC.NOOP,onScrollEnd:DC.NOOP,onControlsIn:DC.NOOP,onControlsOut:DC.NOOP,handleMouseOver:function(e){this.isOver=true;this._showScrollbar();},handleMouseOut:function(e){this.isOver=false;if(this.showScrollBar=="auto"){this._hideScrollbarLater();}},handleMouseDown:function(e){var self=this;if(!this.allowScroll){return;}DC.HCI.disableDrag();this._showScrollbar();$("body").bind("mouseup",function(e){DC.HCI.enableDrag();self.target.ui.unbind("mousemove");self.handleMouseUp(e);});this.isMouseDown=true;this.isMove=false;this._startScroll();this._lastPointerPosition.x=e.pageX;this._lastPointerPosition.y=e.pageY;},handleMouseUp:function(e){$("body").unbind("mouseup");if(!this.allowScroll){return;}this._endScroll();this.isMouseDown=false;},handleMouseMove:function(e){if(this.isMouseDown){this._pointerMove(e.pageX,e.pageY);}},handleTouchStart:function(e){if(!this.allowScroll){return;}this._numberOfTouch++;if(!this.isGesture){this.isMove=false;this._showScrollbar();this._startScroll();this._lastPointerPosition.x=e.originalEvent.targetTouches[0].clientX;this._lastPointerPosition.y=e.originalEvent.targetTouches[0].clientY;
if(e.originalEvent.targetTouches.length==1){this._lastPointerMiddlePosition.x=this._lastPointerPosition.x;this._lastPointerMiddlePosition.y=this._lastPointerPosition.y;}else{this._lastPointerMiddlePosition.x=(this._lastPointerPosition.x+e.originalEvent.targetTouches[1].clientX)/2;this._lastPointerMiddlePosition.y=(this._lastPointerPosition.y+e.originalEvent.targetTouches[1].clientY)/2;}}},handleGestureStart:function(e){this.isGesture=true;this.isLastGesture=false;},handleTouchMove:function(e){if(!this.isGesture){this._pointerMove(e.originalEvent.targetTouches[0].clientX,e.originalEvent.targetTouches[0].clientY);}},handleGestureChange:function(e){this.isGesture=true;if(this.allowScale){this._hscroll=this._vscroll="auto";var s=e.originalEvent.scale*this.scale;var xx=(this._lastPointerMiddlePosition.x-this._targetOffsetPosition.x);var yy=(this._lastPointerMiddlePosition.y-this._targetOffsetPosition.y);var x=xx-(xx-this._currentOffsetPosition.x)*s/this.scale;var y=yy-(yy-this._currentOffsetPosition.y)*s/this.scale;this.scrollTo(x,y,0,s);}},handleGestureEnd:function(e){if(this.allowScale){this._updateScale(e.originalEvent.scale*this.scale);}this._speed.x=this._speed.y=0;this.isLastGesture=true;},handleTouchEnd:function(e){this._numberOfTouch--;if(this._numberOfTouch==0){this.isGesture=false;if(this.showScrollBar=="auto"){this._hideScrollbarLater();}DC.HCI.enableTouch();this._endScroll();}},_showScrollbar:function(){if(this.showScrollBar=="auto"){if(this._timer){clearTimeout(this._timer);}if(this._vscroll!="off"&&this._vscrollbar){this._vscrollbar.setVisible(true,true);}if(this._hscroll!="off"&&this._hscrollbar){this._hscrollbar.setVisible(true,true);}}},_hideScrollbarLater:function(immediate){var self=this;if(this._timer){clearTimeout(this._timer);}if(immediate){if(self._vscrollbar){self._vscrollbar.setVisible(false,true);}if(self._hscrollbar){self._hscrollbar.setVisible(false,true);}}else{this._timer=setTimeout(function(){if(self._vscrollbar){self._vscrollbar.setVisible(false,true);}if(self._hscrollbar){self._hscrollbar.setVisible(false,true);}},1000);}},_startScroll:function(){this.bound=false;this.isInScroll=true;this.isFirstMove=true;this._currentOffsetPosition.x=this._tempOffsetPosition.x=this._lastOffsetPosition.x;this._currentOffsetPosition.y=this._tempOffsetPosition.y=this._lastOffsetPosition.y;var offset=this.target.ui.offset();this._targetOffsetPosition.x=offset.left;this._targetOffsetPosition.y=offset.top;},_endScroll:function(t){if(t!=0){this._isEndScroll=true;}var x=this._lastOffsetPosition.x;var y=this._lastOffsetPosition.y;if(t==undefined){t=0.3;}if(this.snap.x>5){x=Math.round(x/this.snap.x)*this.snap.x;}if(this.snap.y>5){y=Math.round(y/this.snap.y)*this.snap.y;}if(x>0){x=0;this.bound=true;}else{if(x<-this.maxHorizontalScrollPosition){x=-this.maxHorizontalScrollPosition;this.bound=true;}}if(y>0){y=0;this.bound=true;}else{if(y<-this.maxVerticalScrollPosition){y=-this.maxVerticalScrollPosition;this.bound=true;}}this.isInScroll=false;this.scrollTo(x,y,t);},_pointerMove:function(x,y){var tx=x-this._lastPointerPosition.x;var ty=y-this._lastPointerPosition.y;if(tx>5||ty>5){this.isMove=true;}if(this.isFirstMove){this.isFirstMove=false;this.onScrollStart();}this._speed.x=x-this._last.x;this._speed.y=y-this._last.y;this._last.x=x;this._last.y=y;this._currentOffsetPosition.x=this._tempOffsetPosition.x+tx;this._currentOffsetPosition.y=this._tempOffsetPosition.y+ty;this.scrollTo(this._tempOffsetPosition.x+tx,this._tempOffsetPosition.y+ty,0.02);},_addEvents:function(target){if(this._eventsReady){return;}this._eventsReady=true;if(target){var self=this;if(DC.System.isTouch){target.ui.bind({touchstart:function(e){if(!self.allowScroll||self.lockScroll||self._scrollbarScroll){return;}target.ui.bind({touchmove:function(e){self.handleTouchMove(e);},touchend:function(e){DC.HCI.enableTouch();target.ui.unbind("touchmove");target.ui.unbind("touchend");self.handleTouchEnd(e);},gesturestart:function(e){self.handleGestureStart(e);},gesturechange:function(e){self.handleGestureChange(e);},gestureend:function(e){target.ui.unbind("gesturestart");target.ui.unbind("gesturechange");target.ui.unbind("gestureend");self.handleGestureEnd(e);}});DC.HCI.disableTouch();self.handleTouchStart(e);}});}else{target.ui.bind("mousedown",function(e){if(self.allowScroll&&!self.lockScroll&&!self._scrollbarScroll){self.handleMouseDown(e);target.ui.bind("mousemove",function(e){self.handleMouseMove(e);});}});target.ui.bind("mouseover",function(e){if(!self.isOver){self.handleMouseOver(e);}});target.ui.bind("mouseout",function(e){var offset=target.ui.offset();if(e.pageX<offset.left||e.pageX>offset.left+target.width||e.pageY<offset.top||e.pageY>offset.top+target.height){self.handleMouseOut(e);}});}}},_removeEvents:function(target){if(!this._eventsReady){return;}this._eventsReady=false;if(DC.System.isTouch){target.ui.unbind("touchstart");target.ui.unbind("touchmove");target.ui.unbind("touchend");target.ui.unbind("gesturestart");target.ui.unbind("gesturechange");target.ui.unbind("gestureend");}else{target.ui.unbind("mousedown");target.ui.unbind("mouseover");target.ui.unbind("mouseout");}},_updateScrollBar:function(containerW,containerH,contentW,contentH){var self=this;this.maxHorizontalScrollPosition=Math.round(contentW-containerW);this.maxVerticalScrollPosition=Math.round(contentH-containerH);if(this.maxHorizontalScrollPosition<0){this.maxHorizontalScrollPosition=0;}if(this.maxVerticalScrollPosition<0){this.maxVerticalScrollPosition=0;}if(this.contentAlign==DC.Alignment.CENTER){this.minHorizontalScrollPosition=(containerW-contentW)/2;this.minVerticalScrollPosition=(containerH-contentH)/2;if(this.minHorizontalScrollPosition>=-1&&this.minHorizontalScrollPosition<=1){this.minHorizontalScrollPosition=0;}if(this.minVerticalScrollPosition<=-1&&this.minVerticalScrollPosition<=1){this.minVerticalScrollPosition=0;}}else{this.minHorizontalScrollPosition=0;this.minVerticalScrollPosition=0;}var sw=DC.System.isTouch?5:15;if(this.showScrollBar){if(contentW-containerW<=0){this.maxHorizontalScrollPosition=0;this._hideScrollbarLater(true);}else{if(this.showScrollBar!="off"){if(this._hscrollbar==null){this._hscrollbar=new DC.UIScrollbar({onMouseOver:function(){self._scrollbarScroll=true;},onMouseOut:function(){self._scrollbarScroll=false;},onScroll:function(value){self.manualScrollTo(-self.maxHorizontalScrollPosition*value,-self.verticalScrollPosition,Math.abs(self._lastScrollPosiiton-value)*6);self._lastScrollPosiiton=value;}});this.target.addChild(this._hscrollbar,true);}this._hscrollbar.setVertical(false);this._hscrollbar.contentPercentage=containerW/contentW;this._hscrollbar.setXY(2,containerH-sw-2);this._hscrollbar.setSize(containerW-sw-10,sw);this._showScrollbar();}}if(contentH-containerH<=0){this.maxVerticalScrollPosition=0;this._hideScrollbarLater(true);}else{if(this.showScrollBar!="off"){if(this._vscrollbar==null){this._vscrollbar=new DC.UIScrollbar({onMouseOver:function(){self._scrollbarScroll=true;},onMouseOut:function(){self._scrollbarScroll=false;},onScroll:function(value){self.manualScrollTo(-self.horizontalScrollPosition,-self.maxVerticalScrollPosition*value,Math.abs(self._lastScrollPosiiton-value)*6);self._lastScrollPosiiton=value;}});this.target.addChild(this._vscrollbar,true);}this._vscrollbar.setVertical(true);this._vscrollbar.contentPercentage=containerH/contentH;this._vscrollbar.setXY(containerW-sw-2,2);this._vscrollbar.setSize(sw,containerH-sw-10);this._showScrollbar();}}}this._hscroll=(this.maxHorizontalScrollPosition==0)?"off":this.horizontalScrollPolicy;this._vscroll=(this.maxVerticalScrollPosition==0)?"off":this.verticalScrollPolicy;},_updateScale:function(s){this.scale=s;if(this.scale>this.maxScale){this.scale=this.maxScale;}else{if(this.scale<this.minScale){this.scale=this.minScale;}}this._updateScrollBar(this._containerWidth,this._containerHeight,this._contentWidth*this.scale,this._contentHeight*this.scale);},init:function(options){$.extend(this,options);this._super(options);this.setTarget(options.target);
},updateRectangle:function(containerW,containerH,contentW,contentH){var self=this;var changed=false;if(this._containerWidth!=containerW||this._containerHeight!=containerH||this._contentWidth!=contentW||this._contentHeight!=contentH){changed=true;}this._containerWidth=containerW;this._containerHeight=containerH;this._contentWidth=contentW;this._contentHeight=contentH;this._updateScrollBar(containerW,containerH,contentW*this.scale,contentH*this.scale);var cx=this.horizontalScrollPosition-this.maxHorizontalScrollPosition;var cy=this.verticalScrollPosition-this.maxVerticalScrollPosition;if(cx>0||cy>0){this.scrollTo(-this.maxHorizontalScrollPosition,-this.maxVerticalScrollPosition);}this._endScroll(0);},scrollTo:function(x,y,t,s){if(this.horizontalScrollPosition!=x||this.verticalScrollPosition!=y||s!=this.scale){if(this._vscroll=="off"){y=this.minVerticalScrollPosition;}if(this._hscroll=="off"){x=this.minHorizontalScrollPosition;}s=(s==undefined)?this.scale:s;if(x<0.1&&x>-0.1){x=0;}if(y<0.1&&y>-0.1){y=0;}this.horizontalScrollPosition=-x;this.verticalScrollPosition=-y;var b=(this._lastOffsetPosition.x-x!=0&&this._lastOffsetPosition.y-y!=0);this._lastOffsetPosition.x=x;this._lastOffsetPosition.y=y;if(this._vscrollbar){this._vscrollbar.setValue(this.verticalScrollPosition/this.maxVerticalScrollPosition);}if(this._hscrollbar){this._hscrollbar.setValue(this.horizontalScrollPosition/this.maxHorizontalScrollPosition);}if(this.allowScroll){this.onScroll(x,y,s,t);var self=this;if(this._isEndScroll){this._isEndScroll=false;if(this._endScrollTimer){clearTimeout(this._endScrollTimer);}if(t==0){self.onScrollEnd(x,y,self.isInScroll);}else{this._endScrollTimer=setTimeout(function(){self.onScrollEnd(x,y,self.isInScroll);},t*1000);}}}}},scaleTo:function(s,t){if(s){var lastScale=this.scale;this._updateScale(s);var x=this._containerWidth/2-(this._containerWidth/2+this.horizontalScrollPosition)*this.scale/lastScale;var y=this._containerHeight/2-(this._containerHeight/2+this.verticalScrollPosition)*this.scale/lastScale;if(x>0){x=0;this.bound=true;}else{if(x<-this.maxHorizontalScrollPosition){x=-this.maxHorizontalScrollPosition;this.bound=true;}}if(y>0){y=0;this.bound=true;}else{if(y<-this.maxVerticalScrollPosition){y=-this.maxVerticalScrollPosition;this.bound=true;}}this.scrollTo(x,y,t);}},manualScrollTo:function(x,y,t){this.onScrollStart();this._isEndScroll=true;this.scrollTo(x,y,t);},reset:function(x,y,t){this.scaleTo(this.minScale);},setTarget:function(value){this.snap={x:0,y:0};this._last={x:0,y:0};this._speed={x:0,y:0};this._lastPointerMiddlePosition={x:0,y:0};this._lastPointerPosition={x:0,y:0};this._lastOffsetPosition={x:0,y:0};this._tempOffsetPosition={x:0,y:0};this._currentOffsetPosition={x:0,y:0};this._targetOffsetPosition={x:0,y:0};var self=this;if(value){this.target.setXY(0,0);this.target=value;}else{if(this.target){this._removeEvents(this.target);this.target=null;}}},setAllowScroll:function(value){this.allowScroll=value;if(this.target){if(this.allowScroll){this._addEvents(this.target);this.onControlsOut();}else{this._removeEvents(this.target);this.onControlsIn();}}}};window.DC.ScrollController=Interface.extend(DC.ScrollController);})(jQuery);(function($){DC.UI_ID=0;DC.UI={UID:"ui",id:"",x:0,y:0,rotation:0,scale:1,width:"",height:"",defaultWidth:"",defaultHeight:"",innerWidth:"",innerHeight:"",visible:true,clipping:true,styles:"",background:false,parent:null,root:null,ui:null,enabled:true,onSetRoot:DC.NOOP,onAdd:DC.NOOP,onRemove:DC.NOOP,_padding:null,_paddingWithoutBorder:null,_background:null,_haveEvents:false,_sizeChanged:true,init:function(options){$.extend(this,options);this._padding={left:0,right:0,top:0,bottom:0};this._paddingWithoutBorder={left:0,right:0,top:0,bottom:0};this.UID="ui_"+DC.UI_ID;DC.UI_ID++;if(options){this.defaultWidth=(options.width==undefined)?"":options.width;this.defaultHeight=(options.height==undefined)?"":options.height;}this.createChildren();this.setClipping(this.clipping);this.createComplete();this.setSize();this.setEnabled(this.enabled);},createChildren:function(){this.ui=$('<div class="float"></div>');if(!this.visible){this.ui.hide();}if(this.id!=""){this.ui.attr("id",this.id);}if(this.styles!=""){this.ui.addClass(this.styles);}this.setBackground(this.background);},createComplete:function(){},invalidatelLayout:function(w,h){this.setWidth(w);this.setHeight(h);if(this.width!=w||this.height!=h){this._sizeChanged=true;}},commitSize:function(){if(this.ui){if(DC.transform.enabled){this.ui.width(this.innerWidth);this.ui.height(this.innerHeight);}else{this.ui.width(this.innerWidth*this.scale);this.ui.height(this.innerHeight*this.scale);}}},setWidth:function(value){this._paddingWithoutBorder.left=DC.num(this.ui.css("padding-left"));this._paddingWithoutBorder.right=DC.num(this.ui.css("padding-right"));this._padding.left=this._paddingWithoutBorder.left+DC.num(this.ui.css("border-left-width"));this._padding.right=this._paddingWithoutBorder.right+DC.num(this.ui.css("border-right-width"));if(value==undefined||value==""||isNaN(value)){if(this.defaultWidth!=""){this.width=this.defaultWidth;}else{this.ui.width("");this.width=this.ui.outerWidth();}}else{this.width=value;}this.innerWidth=this.width-this._padding.left-this._padding.right;},setHeight:function(value){this._paddingWithoutBorder.top=DC.num(this.ui.css("padding-top"));this._paddingWithoutBorder.bottom=DC.num(this.ui.css("padding-bottom"));this._padding.top=this._paddingWithoutBorder.top+DC.num(this.ui.css("border-top-width"));this._padding.bottom=this._paddingWithoutBorder.bottom+DC.num(this.ui.css("border-bottom-width"));if(value==undefined||value==""||isNaN(value)){if(this.defaultHeight!=""){this.height=this.defaultHeight;}else{this.ui.height("");this.height=this.ui.outerHeight();}}else{this.height=value;}this.innerHeight=this.height-this._padding.top-this._padding.bottom;},addEvent_:function(){},removeEvent_:function(){},css:function(){if(this.ui){if(arguments.length==1){return this.ui.css(arguments[0]);}else{if(arguments.length==2){return this.ui.css(arguments[0],arguments[1]);}}}return null;},addClass:function(cls){if(this.ui){this.ui.addClass(cls);}},removeClass:function(cls){if(this.ui){this.ui.removeClass(cls);}},addEvent:function(){if(!this._haveEvents){this._haveEvents=true;this.addEvent_();}},removeEvent:function(){if(this._haveEvents){this._haveEvents=false;this.removeEvent_();}},attachTo:function(id){log("attach to");this.addClass("dc_ui");$(id).append(this.ui);this.setRoot(this);this.setSize();},setEnabled:function(value){this.enabled=value;if(value){this.removeClass("disabled");}else{this.addClass("disabled");}},setRoot:function(root){this.root=root;if(this.root){this.addEvent();}this.onSetRoot(root);},setVisible:function(value,animate){if(this.visible!=value){this.visible=value;if(this.ui){if(animate){if(this.visible){this.ui.fadeIn(animate);}else{this.ui.fadeOut(animate);}}else{if(this.visible){this.ui.show();}else{this.ui.hide();}}}}},setSize:function(w,h){this._sizeChanged=false;if(w!=undefined&&w!=""){if(this.width!=w){this._sizeChanged=true;}this.width=w;}if(h!=undefined&&h!=""){if(this.height!=h){this._sizeChanged=true;}this.height=h;}this.invalidatelLayout(this.width,this.height);if(this.root){this.commitSize();}},setTransform:function(pos,t,ease,f){this.x=pos.x;this.y=pos.y;this.rotation=pos.rotation;this.scale=pos.scale;DC.transform.setTransform(this,this.x,this.y,t,ease,this.scale,f,this.rotation);},setXY:function(x,y,t,ease,f){this.x=x;this.y=y;DC.transform.setTransform(this,x,y,t,ease,this.scale,f,this.rotation);},setRotation:function(r,t,ease,f){this.rotation=r;DC.transform.setTransform(this,this.x,this.y,0,"linear",this.scale,f,this.rotation);},setScale:function(x,y,s,t,ease,f){this.scale=s;this.x=x;this.y=y;if(!DC.transform.enabled){this.setSize();}DC.transform.setTransform(this,x,y,t,ease,this.scale,f);},setClipping:function(value){if(this.ui){this.clipping=value;if(value){this.ui.addClass("mask");}else{this.ui.removeClass("mask");}}},setBackground:function(value){if(value){this.addClass("background");
}else{if(this._background){this.removeClass("background");}}this.background=value;}};DC.UI=Class.extend(DC.UI);DC.Container={children:null,container:null,numChildren:0,_childrenIndex:null,createChildren:function(){this._super();this.children=[];this._childrenIndex={};this.container=this.ui;},setRoot:function(root){this._super(root);for(var i in this.children){this.children[i].setRoot(root);}},_updateIndex:function(){for(var i in this.children){this.children[i].INDEX=i;this.children[i].css("z-index",i);}this.maxZIndex=this.numChildren=this.children.length;},addChild:function(child,updatelater){this.addChildAt(child,this.children.length,updatelater);},removeChild:function(child,updatelater){for(var i in this.children){if(this.children[i]==child){this.removeChildAt(i,updatelater);break;}}},addChildAt:function(child,index,updatelater){if(child&&child.ui){if(this._childrenIndex[child.UID]){}else{this._childrenIndex[child.UID]=true;child.setRoot(this.root);child.parent=this;if(index>=this.children.length){this.children.push(child);this.container.append(child.ui);}else{this.children.splice(index,0,child);$(this.container.children().get(index)).before(child.ui);}this._updateIndex();if(updatelater){updatelater=updatelater;}else{if(this.root){this.root.setSize();}}child.onAdd(this);}}},removeChildAt:function(index,updatelater){if(index>=0&&index<this.children.length){var child=this.children[index];if(this._childrenIndex[child.UID]){child.setRoot(null);child.parent=null;if(index>=this.children.length){this.children.pop();}else{this.children.splice(index,1);}child.ui.detach();this._updateIndex();delete this._childrenIndex[child.UID];if(updatelater){updatelater=updatelater;}else{if(this.root){this.root.setSize();}}child.onRemove(this);return child;}}return null;},removeAllChildren:function(){for(var i in this.children){this.children[i].ui.detach();}this.children=[];this._childrenIndex={};},contains:function(ui){if(ui){return this._childrenIndex[ui.UID]||false;}return false;},bringToFront:function(c){c.css("z-index",this.maxZIndex);this.maxZIndex++;},maxZIndex:0};window.DC.Container=DC.UI.extend(DC.Container);})(jQuery);(function($){DC.UIScrollbar={vertical:false,value:0,contentPercentage:0.5,_handler:null,_isMouseDownHandler:false,_currentPosition:{x:0,y:0},_mouseDownPosition:{x:0,y:0},_maxPosition:0,_handlerSize:20,onMouseDown:DC.NOOP,onMouseUp:DC.NOOP,onMouseOver:DC.NOOP,onMouseOut:DC.NOOP,onScroll:DC.NOOP,createChildren:function(){this._currentPosition={x:0,y:0};this._mouseDownPosition={x:0,y:0};this.background=true;this._super();this.addClass("UIScrollbar");this._handler=new DC.UI({styles:"handler"});DC.synthesize("vertical",this);DC.synthesize("value",this);DC.synthesize("contentPercentage",this);},createComplete:function(){this._super();this.addChild(this._handler);},commitSize:function(){this._super();if(this.vertical){this._handlerSize=this.height*this.contentPercentage;this._maxPosition=this.height-this._handlerSize;this._handler.setSize(this.width,this._handlerSize);}else{this._handlerSize=this.width*this.contentPercentage;this._maxPosition=this.width-this._handlerSize;this._handler.setSize(this._handlerSize,this.height);}},addEvent_:function(){this._super();var self=this;this._handler.ui.mouseover(function(e){self._inHandler=true;self.onMouseOver(e);});this._handler.ui.mouseout(function(e){self._inHandler=false;self.onMouseOut(e);});this._handler.ui.mousedown(function(e){self._inHandler=true;self._isMouseDownHandler=true;self._mouseDownPosition.x=e.pageX;self._mouseDownPosition.y=e.pageY;self._currentPosition.x=self._handler.x;self._currentPosition.y=self._handler.y;self.handleMouseDown(e);});this.ui.mousedown(function(e){if(self._inHandler){return;}var offset=self.ui.offset();if(self.vertical){self.setValue((e.pageY-offset.top)/self.innerHeight);}else{self.setValue((e.pageX-offset.left)/self.innerWidth);}self.onScroll(self.value);});},commitProperties:function(prop,value){switch(prop){case"vertical":if(value){this.handleMouseMove=this.handleMouseMoveY;}else{this.handleMouseMove=this.handleMouseMoveX;}break;case"value":if(this.vertical){this._handler.setXY(0,value*this._maxPosition);}else{this._handler.setXY(value*this._maxPosition,0);}break;case"contentPercentage":this.commitSize();break;}},handleMouseDown:function(e){var self=this;self.onMouseDown(e);$("body").mousemove(function(e){if(self.vertical){self.handleMouseMoveY(e);}else{self.handleMouseMoveX(e);}});$("body").mouseup(function(e){self._mouseDownPosition.y=0;self._mouseDownPosition.x=0;self.onMouseUp(e);self._isMouseDownHandler=false;$("body").unbind("mouseup");$("body").unbind("mousemove");});},handleMouseMoveX:function(e){var pos=this._currentPosition.x-(this._mouseDownPosition.x-e.pageX);if(pos<0){pos=0;}if(pos>this._maxPosition){pos=this._maxPosition;}this._handler.setXY(pos,0);this.handleValueChange(pos/this._maxPosition);},handleMouseMoveY:function(e){var pos=this._currentPosition.y-(this._mouseDownPosition.y-e.pageY);if(pos<0){pos=0;}if(pos>this._maxPosition){pos=this._maxPosition;}this._handler.setXY(0,pos);this.handleValueChange(pos/this._maxPosition);},handleMouseMove:this.handleMouseMoveY,handleValueChange:function(val){if(val!=this.value){this.setValue(val);this.onScroll(val);}}};window.DC.UIScrollbar=DC.Container.extend(DC.UIScrollbar);})(jQuery);(function($){DC.UIImage={source:null,resizeMode:DC.Size.AUTO_FILL,alignment:DC.Alignment.CENTER,border:0,borderColor:"#FFFFFF",loaded:false,_border:null,_img:null,_imgWidth:0,_imgHeight:0,_imgContainer:null,onLoad:DC.NOOP,createChildren:function(){this.clipping=false;this._super();this._border=$('<div class="border mask"></div>');this.addClass("loading");},createComplete:function(){this._super();this.addClass("UIImage");this.ui.append(this._border);if(this.source){this._load(this.source);}},commitSize:function(){this._super();if(this._img){this._border.css({"border-width":this.border,"border-color":this.borderColor});var bx=DC.num(this._border.css("border-left-width"))+DC.num(this._border.css("border-right-width"));var by=DC.num(this._border.css("border-top-width"))+DC.num(this._border.css("border-bottom-width"));var pos={"margin-left":0,"margin-top":0};var xx,yy;var size=DC.Size.getSize(this._imageWidth,this._imageHeight,this.width,this.height,this.resizeMode,this.alignment);if(DC.transform.enabled){if(size.width>this.width){bx=this.width-bx;}else{pos["margin-left"]=size.tx;bx=size.width-bx;}if(size.height>this.height){by=this.height-by;}else{pos["margin-top"]=size.ty;by=size.height-by;}this._border.width(bx);this._border.height(by);this._border.css(pos);$(this._img).width(size.width);$(this._img).height(size.height);xx=(size.tx<0)?size.tx:0;yy=(size.ty<0)?size.ty:0;$(this._img).css({"margin-left":xx,"margin-top":yy});}else{if(size.width>this.width){bx=this.width-bx;}else{pos["margin-left"]=size.tx*this.scale;bx=size.width-bx;}if(size.height>this.height){by=this.height-by;}else{pos["margin-top"]=size.ty*this.scale;by=size.height-by;}this._border.width(bx*this.scale);this._border.height(by*this.scale);this._border.css(pos);$(this._img).width(size.width*this.scale);$(this._img).height(size.height*this.scale);xx=(size.tx<0)?size.tx:0;yy=(size.ty<0)?size.ty:0;$(this._img).css({"margin-left":xx*this.scale,"margin-top":yy*this.scale});}}},handleImageLoad:function(img){this._imageWidth=img.width;this._imageHeight=img.height;this._border.prepend(this._img);this.commitSize();if(!$.browser.msie){this._border.show();}this.onLoad();},_load:function(src){var self=this;if(src==null){return;}this.loaded=false;if($.browser.msie){src=src+"?"+Math.random();}if(this._img){this._img.src=DC.BLANK_IMAGE;this._border.empty();}this._img=new Image();if(!$.browser.msie){this._border.hide();}this._img.onload=function(){this.onload=DC.NOOP;self.loaded=true;self.handleImageLoad(this);};this._img.src=src;},setSource:function(src){if(src&&src!=this.source){this.source=src;this._load(src);}}};window.DC.UIImage=DC.UI.extend(DC.UIImage);DC.UIImageWidthCaption={};})(jQuery);
(function($){DC.UIText={text:"",_container:null,_textDirty:false,createChildren:function(){this._super();this.addClass("UIText");this._container=$('<div styles="display:block;"></div>');},createComplete:function(){this._super();this.ui.append(this._container);this.setText(this.text);},setHeight:function(value){this._super(value);if(this._textDirty){this._textDirty=false;this.innerHeight=this._container.height();this.height=this.innerHeight+this._padding.top+this._padding.bottom;}},commitSize:function(){this._super();var ih=this._container.height();this.height=ih+this._padding.top+this._padding.bottom;if(ih!=0&&ih<=this.innerHeight){this._container.css("margin-top",(this.innerHeight-ih)/2);}else{this._container.css("margin-top","");}this.height=this.ui.height()+this._padding.top+this._padding.bottom;this.width=this.ui.width()+this._padding.left+this._padding.right;},upateText:function(txt){this._container.empty();this._container.append(txt);this._textDirty=true;this.setSize();},setText:function(txt){if(txt){this.text=txt;}else{this.text="";}this.upateText(this.text);}};window.DC.UIText=DC.UI.extend(DC.UIText);})(jQuery);(function($){DC.UIButton={icon:null,_icon:null,onClick:DC.NOOP,onOver:DC.NOOP,onOut:DC.NOOP,onDown:DC.NOOP,onUp:DC.NOOP,createChildren:function(){this._super();this.removeClass("UIText");this.addClass("UIButton glossy");},createComplete:function(){this._super();var self=this;this.setIcon(this.icon);},addEvent_:function(){this._super();var self=this;if(!DC.System.isTouch){this.ui.hover(function(){DC.HCI.disableDrag();self.handleMouseOver();},function(){DC.HCI.enableDrag();self.handleMouseOut();});}this.ui.mousedown(function(){self.handleMouseDown();});this.ui.mouseup(function(){self.handleMouseUp();});this.ui.click(function(){self.handleMouseClick();});},handleMouseOver:function(){if(this.enabled){this.addClass("over");this.onOver();}},handleMouseOut:function(){if(this.enabled){this.removeClass("over");this.onOut();}},handleMouseDown:function(){if(this.enabled){this.addClass("down");this.onDown();}},handleMouseUp:function(){if(this.enabled){this.removeClass("down");this.removeClass("over");this.onUp();}},handleMouseClick:function(){if(this.enabled){this.onClick();}},upateText:function(txt){this._super(txt);if(this._icon){this._container.prepend(this._icon);this.ui.css({width:""});}},setIcon:function(src){if(typeof src=="string"&&src!=""){this.icon=src;if(this._icon==null){this._icon=new Image();}this._icon.onload=function(){$(this).css({"float":"left","width":this.width});};this._icon.src=src;$(this._icon).css({"float":"left","width":16});this._container.prepend(this._icon);}else{if(this._icon!=null){$(this._icon).detach();}}}};window.DC.UIButton=DC.UIText.extend(DC.UIButton);})(jQuery);(function($){DC.AbstractLayout={target:null,gap:3,width:"",height:"",numChildren:0,needPreprocess:false,needInvalidate:true,_sizes:null,_sizesIndex:null,_count:0,_notChange:true,init:function(options){$.extend(this,options);},calculateChildrenSize:function(index){},calculateChildrenPosition:function(index,pos){},getLayoutSize:function(){return null;},initLayout:function(){this._sizes=[];this._sizesIndex=[];this._notChange=true;},preprocess:function(){},layout:function(){this.initLayout();for(var i=0;i<this.numChildren;i++){this._sizes[i]=this.calculateChildrenSize(i);}for(var k=0;k<this.numChildren;k++){this.calculateChildrenPosition(k,this._sizes[k]);}return this.getLayoutSize();},getTransform:function(index){return this._sizes[index]||{x:0,y:0,width:0,height:0,scale:1};}};window.DC.AbstractLayout=Class.extend(DC.AbstractLayout);DC.BoxLayout={vertical:false,_maxW:0,_maxH:0,_avg:0,_avgCount:0,_avgTotal:0,calculateChildrenSize:function(c){var s=this.vertical?c.ui.outerHeight():c.ui.outerWidth();var ss={width:0,height:0,scale:1};if(c.visible){if(this.vertical){ss.width=(this.width=="")?c.width:this.width;ss.height=(c.defaultHeight=="")?s:c.defaultHeight;if(c.defaultHeight!=""){this._avgTotal+=ss.height;this._avgCount++;}}else{ss.width=(c.defaultWidth=="")?s:c.defaultWidth;ss.height=(this.height=="")?c.height:this.height;this._max=(this._max>ss.height)?this._max:ss.height;if(c.defaultWidth!=""){this._avgTotal+=ss.width;this._avgCount++;}}if(ss.width==0){ss.width=c.ui.outerWidth();}if(ss.height==0){ss.height=c.ui.outerHeight();}this._maxW=(this._maxW>ss.width)?this._maxW:ss.width;this._maxH=(this._maxH>ss.height)?this._maxH:ss.height;}return ss;},calculateChildrenPosition:function(c,pos){var p=0;if(this.vertical){for(var i in this._sizesIndex){var cc=this._sizes[this._sizesIndex[i]];if(this._sizesIndex[i]==c.UID){break;}else{p+=cc.height+this.gap;}}pos.x=0;pos.y=p;}else{for(var k in this._sizesIndex){var cd=this._sizes[this._sizesIndex[k]];if(this._sizesIndex[k]==c.UID){break;}else{p+=cd.width+this.gap;}}pos.x=p;pos.y=0;}return pos;},initLayout:function(){this._super();this._avg=0;this._avgCount=0;this._avgTotal=0;},preprocess:function(children){if(this._count-this._avgCount>0){var ss=(this.width-this._avgTotal)/(this._count-this._avgCount)-this.gap*2;for(var i in children){c=children[i];size=this._sizes[c.UID];if(!this.vertical&&c.defaultWidth==""){size.width=ss;}else{if(this.vertical&&c.defaultHeight==""){size.height=ss;}}}}},getLayoutSize:function(){var sizes={width:0,height:0};for(var i in this._sizes){var size=this._sizes[i];if(this.vertical&&size.height){sizes.height+=size.height+this.gap;}if(!this.vertical&&size.width){sizes.width+=size.width+this.gap;}}if(this.width==""){sizes.width=this._maxW;}if(sizes.width==0){sizes.width=this.width;}if(sizes.width<this.width){sizes.width=this.width;}if(this.height==""){sizes.height=this._maxH;}if(sizes.height==0){sizes.height=this.height;}if(sizes.height<this.height){sizes.height=this.height;}return sizes;}};window.DC.BoxLayout=DC.AbstractLayout.extend(DC.BoxLayout);DC.GridLayout={rowCount:0,columnCount:0,rowHeight:30,columnWidth:30,direction:0,_countLimit:0,_savedColumnWidth:null,_savedRowHeight:null,initLayout:function(){this._super();if(this.numChildren<=0){return;}if(this.direction==0){if(this.columnCount<=0){if(this.rowCount<=0){this._countLimit=Math.floor((this.width-this.gap)/(this.columnWidth+this.gap));}else{this._countLimit=Math.ceil(this.numChildren/this.rowCount);}}else{this._countLimit=this.columnCount;}}else{if(this.rowCount<=0){if(this.columnCount<=0){this._countLimit=Math.floor((this.height-this.gap)/(this.rowHeight+this.gap));}else{this._countLimit=Math.ceil(this.numChildren/this.columnCount);}}else{this._countLimit=this.rowCount;}}if(this.columnWidth!=this._savedColumnWidth){this._notChange=false;this._savedColumnWidth=this.columnWidth;}if(this.rowHeight!=this._savedRowHeight){this._notChange=false;this._savedRowHeight=this.rowHeight;}if(this.needValidate){this._notChange=false;this.needValidate=false;}},calculateChildrenSize:function(index){return{width:this.columnWidth,height:this.rowHeight,scale:1};},calculateChildrenPosition:function(index,pos){var u=0;var v=0;if(this.direction==0){u=index%this._countLimit;v=Math.floor(index/this._countLimit);}else{u=Math.floor(index/this._countLimit);v=index%this._countLimit;}pos.x=u*(this.columnWidth+this.gap)+this.gap;pos.y=v*(this.rowHeight+this.gap)+this.gap;return pos;},getLayoutSize:function(){var w=this.width;var h=this.height;if(this.columnCount==0&&this.rowCount!=0){var c=Math.ceil(this.numChildren/this.rowCount);w=c*(this.columnWidth+this.gap);h=this.rowCount*(this.rowHeight+this.gap);}else{if(this.rowCount==0&&this.columnCount!=0){w=this.columnCount*(this.columnWidth+this.gap);h=Math.ceil(this.numChildren/this.columnCount)*(this.rowHeight+this.gap);}else{if(this.columnCount!=0&&this.rowCount!=0){w=this.columnCount*(this.columnWidth+this.gap);h=this.rowCount*(this.rowHeight+this.gap);}else{if(this.columnCount==0&&this.rowCount==0){var col=0;var row=0;if(this.direction==0){col=Math.floor((this.width-this.gap)/(this.columnWidth+this.gap));row=Math.ceil(this.numChildren/col);}else{row=Math.floor((this.height-this.gap)/(this.rowHeight+this.gap));col=Math.ceil(this.numChildren/row);
}w=col*(this.columnWidth+this.gap);h=row*(this.rowHeight+this.gap);}}}}if(h<this.height-this.gap){h=this.height-this.gap;}if(w<this.width-this.gap){w=this.width-this.gap;}return{width:w+this.gap,height:h+this.gap};}};window.DC.GridLayout=DC.AbstractLayout.extend(DC.GridLayout);})(jQuery);(function($){DC.DataRenderer={data:[],gap:3,createChildren:function(){this._super();this.addClass("UIDataRenderer");this._selectionBackground=$('<div class="selection_background float"></div>');},createComplete:function(){this.ui.append(this._selectionBackground);this._super();var self=this;var down=DC.System.isTouch?"touchdown":"mousedown";var up=DC.System.isTouch?"touchupn":"mouseup";if(DC.System.isTouch){this.ui.bind({"click":function(){self.dispatchEvent(new DC.ListEvent(DC.ListEvent.CLICK,self,self.data.data,self.data.index));},"touchstart":function(){$(this).addClass("down");self.dispatchEvent(new DC.ListEvent(DC.ListEvent.DOWN,self,self.data.data,self.data.index));},"touchend":function(){$(this).removeClass("down");self.dispatchEvent(new DC.ListEvent(DC.ListEvent.UP,self,self.data.data,self.data.index));}});}else{this.ui.hover(function(){DC.HCI.disableDrag();$(this).addClass("over");self.dispatchEvent(new DC.ListEvent(DC.ListEvent.OVER,self,self.data.data,self.data.index));},function(){DC.HCI.enableDrag();$(this).removeClass("over");self.dispatchEvent(new DC.ListEvent(DC.ListEvent.OUT,self,self.data.data,self.data.index));});this.ui.bind({"click":function(){self.dispatchEvent(new DC.ListEvent(DC.ListEvent.CLICK,self,self.data.data,self.data.index));},"dblclick":function(){self.dispatchEvent(new DC.ListEvent(DC.ListEvent.DOUBLE_CLICK,self,self.data.data,self.data.index));},"mousedown":function(){$(this).addClass("down");self.dispatchEvent(new DC.ListEvent(DC.ListEvent.DOWN,self,self.data.data,self.data.index));},"mouseup":function(){$(this).removeClass("down");self.dispatchEvent(new DC.ListEvent(DC.ListEvent.UP,self,self.data.data,self.data.index));}});}},commitSize:function(){this._super();this._selectionBackground.css({width:this.width+this.gap*2,height:this.height+this.gap*2,left:-this.gap,top:-this.gap});},setData:function(value){var self=this;if(this.data){this.data.onSelected=DC.NOOP;this.data.onDeselected=DC.NOOP;}this.data=value;this.data.onSelected=function(){self.setSelected(true);};this.data.onDeselected=function(){self.setSelected(false);};},setSelected:function(value){if(this._selected!=value){this._selected=value;if(value){this.ui.addClass("selected");}else{this.ui.removeClass("selected");}}}};window.DC.DataRenderer=DC.Container.extend(DC.DataRenderer);DC.DataRendererFactory={dataRenderer:DC.DataRenderer,dataRendererOptions:null,_pool:null,init:function(options){$.extend(this,options);this._pool=[];},handleItemEvent:function(type,item){this.delegate.dispatchEvent(new DC.ListEvent(type,item.data,item.index));},get:function(item,options){var instance=null;var self=this;if(this._pool.length>0){instance=this._pool.pop();}else{instance=new this.dataRenderer(options);}instance.dispatchEvent=function(e){self.delegate.dispatchEvent(e);};item.instance=instance;instance.setData(item);return instance;},recycle:function(instance){instance.data.instance=null;instance.data=null;this._pool.push(instance);},clear:function(){this._pool=[];}};window.DC.DataRendererFactory=Class.extend(DC.DataRendererFactory);DC.UIImageRenderer={align:DC.Alignment.CENTER,resizeMode:DC.Size.AUTO_FILL,sourceLabel:"source",border:0,borderColor:"#FFF",_thumb:null,createChildren:function(){this._super();this.addClass("UIImageRenderer");this._thumb=new DC.UIImage({resizeMode:this.resizeMode,alignment:this.align,border:this.border});},createComplete:function(){this._super();DC.synthesize("border",this);DC.synthesize("borderColor",this);DC.synthesize("resizeMode",this);this.removeClass("mask");this.addChild(this._thumb);},invalidatelLayout:function(w,h){this._super(w,h);this.commitProperties();},commitSize:function(){this._super();this._thumb.setSize(this.width,this.height);},commitProperties:function(prop,value){if(this._thumb){this._thumb.resizeMode=this.resizeMode;this._thumb.border=this.border;this._thumb.borderColor=this.borderColor;}switch(prop){case"border":case"borderColor":case"resizeMode":this.setSize();break;}},setData:function(value){this._super(value);if(this._thumb&&this.data&&this.data.data[this.sourceLabel]){this._thumb.setSource(this.data.data[this.sourceLabel]);}}};window.DC.UIImageRenderer=DC.DataRenderer.extend(DC.UIImageRenderer);DC.UIImageWithCaptionRenderer={caption:"",captionEnabled:true,captionHeight:25,captionPadding:5,_caption:null,createComplete:function(){this._super();if(this.caption){this.setCaption(this.caption);}},commitSize:function(){this._super();if(this.captionEnabled&&this._caption){this._caption.setSize(this.innerWidth,this.captionHeight);var h=this._caption.height;if(h>this.captionHeight){this._caption.setText(this.caption.substring(0,10)+"...");}this._caption.setXY((this.innerWidth-this._caption.width)/2,this.innerHeight-this.captionHeight);this._thumb.setSize(this.innerWidth,this.innerHeight-this.captionHeight-this.captionPadding);}else{if(this._caption){this._caption.setVisible(false);}}},commitProperties:function(prop,value){this._super(prop,value);if(this.data.data){this.setCaption(this.data.data["title"]);}},setCaption:function(value){if(value){this.caption=value;if(this._caption==null){this._caption=new DC.UIText({styles:"caption"});}this._caption.setText(value);this.addChild(this._caption,true);}else{this.caption=value;if(this._caption){this.removeChild(this._caption,true);}}}};window.DC.UIImageWithCaptionRenderer=DC.UIImageRenderer.extend(DC.UIImageWithCaptionRenderer);DC.UIAlbumIcon={_thumbA:null,_thumbB:null,createChildren:function(){this._super();this._thumbA=new DC.UIImage({styles:"R1",resizeMode:this.resizeMode,alignment:this.align,border:this.border});this._thumbB=new DC.UIImage({styles:"R2",resizeMode:this.resizeMode,alignment:this.align,border:this.border});},createComplete:function(){this._super();this.addChildAt(this._thumbA,0);this.addChildAt(this._thumbB,0);},setSize:function(w,h){this._super(w,h);if(this._caption){this._thumb.setSize(this.width-15,this.height-this._caption.height-15);this._thumbA.setSize(this.width-15,this.height-this._caption.height-15);this._thumbB.setSize(this.width-15,this.height-this._caption.height-15);this._thumb.setXY(7.5,7.5);this._thumbA.setXY(10,10);this._thumbB.setXY(10,0);this._thumbA.setRotation(-4);this._thumbB.setRotation(6);}},commitProperties:function(prop,value){this._super(prop,value);this._thumbA.setSource(this.data[this.sourceLabel]);this._thumbB.setSource(this.data[this.sourceLabel]);}};window.DC.UIAlbumIcon=DC.UIImageWithCaptionRenderer.extend(DC.UIAlbumIcon);})(jQuery);(function($){DC.Group={layoutClass:null,animated:0,_layout:null,_layoutTarget:null,createChildren:function(){this._layoutTarget=this;this._super();if(this.layoutClass){this._layout=new this.layoutClass({target:this._layoutTarget});}},commitSize:function(){this._super();if(this._layout){this._layout.target=this._layoutTarget;this._layout.width=this.innerWidth;this._layout.height=this.innerHeight;var sizes=this._layout.layout();if(sizes){this._layoutTarget.innerHeight=sizes.height;this._layoutTarget.height=sizes.height+this._layoutTarget._padding.bottom+this._layoutTarget._padding.top;this._layoutTarget.innerWidth=sizes.width;this._layoutTarget.width=sizes.width+this._layoutTarget._padding.right+this._layoutTarget._padding.left;if(DC.transform.enabled){this._layoutTarget.ui.width(this._layoutTarget.innerWidth);this._layoutTarget.ui.height(this._layoutTarget.innerHeight);}else{this._layoutTarget.ui.width(this._layoutTarget.innerWidth*this._layoutTarget.scale);this._layoutTarget.ui.height(this._layoutTarget.innerHeight*this._layoutTarget.scale);}}this.updateLayout();}},updateLayout:function(){if(this._layout){var g=0;if(this._layout.gap!=undefined){g=this._layout.gap/2;}for(var i in this._layoutTarget.children){var c=this._layoutTarget.children[i];
c.gap=g;this.updateChildrenPosition(c,this._layout.getTransform(c.data.index));}}},updateChildrenPosition:function(c,pos){if(pos.notChange){}else{c.setSize(pos.width,pos.height);}c.setTransform(pos,this.animated);},setChildrenProperty:function(property,value){for(var i in this._layoutTarget.children){var c=this._layoutTarget.children[i];var fc=property.substr(0,1).toUpperCase();var fn="set"+fc+property.substr(1);if(c[fn]){c[fn].call(c,value);}}}};window.DC.Group=DC.Container.extend(DC.Group);DC.Box={gap:4,createChildren:function(){this.layout=DC.BoxLayout;this._super();},invalidatelLayout:function(w,h){this._super(w,h);if(this.layout){this._layout.vertical=this.vertical;this._layout.gap=this.gap;}},updateLayout:function(){if(this._layout){for(var i in this.children){var c=this.children[i];this.updateChildrenPosition(c,this._layout.getTransform(i));}}}};window.DC.Box=DC.Group.extend(DC.Box);DC.VBox={createChildren:function(){this.vertical=true;this._super();}};window.DC.VBox=DC.Box.extend(DC.VBox);DC.HBox={createChildren:function(){this.vertical=false;this._super();}};window.DC.HBox=DC.Box.extend(DC.HBox);DC.Tile={gap:4,direction:0,createChildren:function(){this.layout=DC.GridLayout;this._super();},invalidatelLayout:function(w,h){this._super(w,h);if(this._layout){this._layout.gap=this.gap;this._layout.direction=this.direction;}}};window.DC.Tile=DC.Group.extend(DC.Tile);DC.ListBase={itemRenderer:null,itemRendererOptions:null,containerClass:null,datasource:null,gap:0,_listController:null,_contentContainer:null,onBuildComplete:DC.NOOP,onDataSelected:DC.NOOP,onDataDeselected:DC.NOOP,createChildren:function(){this._super();var self=this;new DC.EventDispatcher({delegate:this});if(this.containerClass){this._contentContainer=new this.containerClass({styles:"content_container",width:this.width,height:this.height});this._contentContainer.removeClass("mask");}else{this._contentContainer=this;}this._layoutTarget=this._contentContainer;this._listController=new DC.ListController({datasource:this.datasource,delegate:this});this._itemFactory=new DC.DataRendererFactory({delegate:this,dataRenderer:this.itemRenderer,dataRendererOptions:this.itemRendererOptions});DC.synthesize("gap",this);},commitProperties:function(prop,value){if(this._layout){this._layout.gap=this.gap;}},invalidatelLayout:function(w,h){this._super(w,h);if(this._contentContainer){this.gap=this.gap;}},build:function(ds){this._contentContainer.removeAllChildren();if(this._layout){this._layout.needInvalidate=true;}this.buildChildren(ds);this.handleBuildComplete();},buildChildren:function(ds){this.updateChildren(0,ds.length());},updateChildren:function(start,count){if(this.datasource){var changed=false;for(var i=start;i<start+count;i++){var item=this._listController.getItem(i);if(item&&!this._contentContainer.contains(item.instance)){var cn=this._itemFactory.get(item,this.itemRendererOptions);if(this.itemRendererOptions.initialX&&this.itemRendererOptions.initialY){cn.setXY(this.itemRendererOptions.initialX,this.itemRendererOptions.initialY);}this._contentContainer.addChild(cn,true);changed=true;}}for(var index in this._contentContainer.children){var c=this._contentContainer.children[index];if(c.data.index<start||c.data.index>=start+count){this._contentContainer.removeChild(c,true);this._itemFactory.recycle(c);changed=true;}}if(changed){this.setSize();}}},handleBuildComplete:function(){if(this._contentContainer!=this){this.addChildAt(this._contentContainer,0,true);}this.setSize();this.onBuildComplete(this.datasource);},handleDataSourceAdd:function(e){this._contentContainer.addChild(this._listController.getItem(e.index,e.data,this.itemRendererOptions));},handleDataSourceRemove:function(e){var item=this._contentContainer.removeChildAt(e.index);this._listController.removeItem(item);}};window.DC.ListBase=DC.Group.extend(window.DC.ListBase);DC.ScrollListBase={_scrollController:null,createChildren:function(){this.containerClass=DC.Container;this._super();var self=this;this._scrollController=new DC.ScrollController({name:this.name,delegate:this,target:this,onScroll:function(x,y,s,t){self.handleScroll(x,y,s,t);}});},setSize:function(w,h){this._super(w,h);this._scrollController.updateRectangle(this.innerWidth,this.innerHeight,this._contentContainer.width,this._contentContainer.height);},onAdd:function(parent){this._super(parent);this._scrollController.setAllowScroll(true);},onRemove:function(parent){this._super(parent);this._scrollController.setAllowScroll(false);},build:function(ds){this._super(ds);this._scrollController.scrollTo(0,0,0);},handleScroll:function(x,y,s,t){if(t>0.02){if(this._scrollController.bound){this._contentContainer.setScale(x,y,s,t,"easeOutBack");}else{this._contentContainer.setScale(x,y,s,t,"easeOutQuad");}}else{this._contentContainer.setScale(x,y,s,0);}}};window.DC.ScrollListBase=DC.ListBase.extend(window.DC.ScrollListBase);})(jQuery);(function($){DC.UIImageScrollView={source:"",minScale:1,maxScale:2,currentScale:1,showControls:true,resizeMode:DC.Size.AUTO,_scrollController:null,_image:null,_zoomInButton:null,_zoomOutButton:null,onScrollLock:DC.NOOP,onScrollUnlock:DC.NOOP,onScrollEnd:DC.NOOP,createChildren:function(){this._super();var self=this;this.addClass("UIImageScrollView");this._image=new DC.UIImage({resizeMode:this.resizeMode,onLoad:function(){self._image.setSize(self._image._imageWidth,self._image._imageHeight);self.setSize();}});this.addChild(this._image);this._scrollController=new DC.ScrollController({name:"uiimagescrollview",delegate:this,target:this,showScrollBar:"auto",allowScale:true,onScroll:function(x,y,s,t){if(self._scrollController.scale<=self._scrollController.minScale){self.onScrollUnlock();}else{self.onScrollLock();}if(t>0.02){if(self._scrollController.bound){self._image.setScale(x+self._paddingWithoutBorder.left,y+self._paddingWithoutBorder.top,s,t,"easeOutBack");}else{self._image.setScale(x+self._paddingWithoutBorder.left,y+self._paddingWithoutBorder.top,s,t,"easeOutQuad");}}else{self._image.setScale(x+self._paddingWithoutBorder.left,y+self._paddingWithoutBorder.top,s,0);}},onControlsIn:function(){self.onScrollLock();},onControlsOut:function(){if(self._scrollController.scale<=self.minScale){self.onScrollUnlock();}}});this._zoomInButton=new DC.UIButton({text:"+",styles:"zoom corner glossy",onDown:function(){self.zoomIn();},onOver:function(){},onOut:function(){}});this._zoomOutButton=new DC.UIButton({text:"-",styles:"zoom corner",onDown:function(){self.zoomOut();},onOver:function(){},onOut:function(){}});this.addClass("UIImageScrollView");},createComplete:function(){this._super();if(this.showControls){this.addChild(this._zoomInButton);this.addChild(this._zoomOutButton);}if(this.source){this.setSource(this.source);}},setSize:function(w,h){this._super(w,h);if(this.showControls){this._zoomInButton.setXY(10,10);this._zoomOutButton.setXY(10,50);}if(this._image&&this._image.loaded){var size=DC.Size.getSize(this._image._imageWidth,this._image._imageHeight,this.width,this.height,this.resizeMode);this._scrollController.minScale=size.width/this._image._imageWidth;this._scrollController.scale=this._scrollController.minScale;this._scrollController.maxScale=this._scrollController.minScale*this.maxScale;}this._scrollController.updateRectangle(this.innerWidth,this.innerHeight,this._image.width,this._image.height);if(this._image&&this._image.loaded){this._image.setScale(-this._scrollController.horizontalScrollPosition,-this._scrollController.verticalScrollPosition,this._scrollController.minScale);}},setEnabled:function(value){this._super(value);this._scrollController.setAllowScroll(value);},reset:function(){this._scrollController.reset();},setSource:function(src){this._image.setSource(src);},zoomIn:function(){this._scrollController.scaleTo(this._scrollController.scale*1.5,0.5);},zoomOut:function(){this._scrollController.scaleTo(this._scrollController.scale/1.5,0.5);}};window.DC.UIImageScrollView=DC.Container.extend(window.DC.UIImageScrollView);})(jQuery);(function($){DC.UIImageList={columnCount:0,rowCount:0,cellWidth:30,cellHeight:30,sourceLabel:"thumbnail",imageResizeMode:DC.Size.AUTO,imageAlign:DC.Alignment.CENTER,snap:{x:0,y:0},direction:0,imageBorder:0,imageBorderColor:"#FFF",createChildren:function(){this.addClass("UITileList");
this.layoutClass=DC.GridLayout;if(this.itemRenderer==null){this.itemRenderer=DC.UIImageRenderer;}this.animated=0.5;this.itemRendererOptions={sourceLabel:this.sourceLabel,width:this.cellWidth,height:this.cellHeight,resizeMode:this.imageResizeMode,align:this.imageAlign,border:this.imageBorder};this._super();this._scrollController.showScrollBar="auto";this._scrollController.snap=this.snap;DC.synthesize("cellWidth",this);DC.synthesize("cellHeight",this);DC.synthesize("rowCount",this);DC.synthesize("columnCount",this);DC.synthesize("sourceLabel",this);DC.synthesize("direction",this);DC.synthesize("imageResizeMode",this);DC.synthesize("imageBorder",this);DC.synthesize("imageBorderColor",this);},commitProperties:function(prop,value){this._super(prop,value);if(this._layout){this._layout.columnWidth=this.cellWidth;this._layout.rowHeight=this.cellHeight;this._layout.direction=this.direction;this._layout.numChildren=this._listController.length();this._layout.rowCount=this.rowCount;this._layout.columnCount=this.columnCount;this._scrollController.snap.x=this.cellWidth;this._scrollController.snap.y=this.cellHeight;this.setChildrenProperty("resizeMode",this.imageResizeMode);this.setChildrenProperty("border",this.imageBorder);this.setChildrenProperty("borderColor",this.imageBorderColor);}},invalidatelLayout:function(w,h){this._super(w,h);this.commitProperties();}};window.DC.UIImageList=DC.ScrollListBase.extend(DC.UIImageList);DC.Thumbnail={vertical:false,createChildren:function(){this._super();this._scrollController.showScrollBar="off";DC.synthesize("vertical",this);this.commitProperties("vertical",this.vertical);},commitProperties:function(prop,value){this._super(prop,value);switch(prop){case"vertical":if(this._layout){if(value){this.columnCount=this._layout.columnCount=1;this.rowCount=this._layout.rowCount=0;}else{this.columnCount=this._layout.columnCount=0;this.rowCount=this._layout.rowCount=1;}}this.setSize();break;}}};window.DC.Thumbnail=DC.UIImageList.extend(DC.Thumbnail);DC.CenterThumbnail={commitProperties:function(prop,value){this._super(prop,value);this._scrollController.snap.x=this.cellWidth+this.gap;},handleScroll:function(x,y,s,t){this._super(x+(this.innerWidth-this.cellWidth-this.gap)/2,y,s,t);}};window.DC.CenterThumbnail=DC.Thumbnail.extend(DC.CenterThumbnail);})(jQuery);(function($){DC.UIPageControlEvent={};window.DC.UIPageControlEvent=DC.Event.extend(DC.UIPageControlEvent);window.DC.UIPageControlEvent.LOCK="lockScroll";window.DC.UIPageControlEvent.UNLOCK="unlockScroll";DC.UIPageRenderer={align:DC.Alignment.CENTER,resizeMode:DC.Size.AUTO,sourceLabel:"source",_imageScrollView:null,createChildren:function(){this._super();var self=this;var lockEvent=new DC.UIPageControlEvent(DC.UIPageControlEvent.LOCK);var unlockEvent=new DC.UIPageControlEvent(DC.UIPageControlEvent.UNLOCK);this._imageScrollView=new DC.UIImageScrollView({showControls:false,resizeMode:this.resizeMode,onScrollUnlock:function(){if(self.dispatchEvent){self.dispatchEvent(unlockEvent);}},onScrollLock:function(){if(self.dispatchEvent){self.dispatchEvent(lockEvent);}}});},createComplete:function(){this._super();this.addChild(this._imageScrollView);},setSize:function(w,h){this._super(w,h);this._imageScrollView.setSize(this.innerWidth,this.innerHeight);},setData:function(value){this._super(value);this._imageScrollView.setSource(this.data.data[this.sourceLabel]);},setEnabled:function(value){this._super(value);this._imageScrollView.setEnabled(value);},reset:function(){},zoomIn:function(){this._imageScrollView.zoomIn();},zoomOut:function(){this._imageScrollView.zoomOut();}};window.DC.UIPageRenderer=DC.DataRenderer.extend(DC.UIPageRenderer);DC.UIPageControl={currentPageView:null,currentPageIndex:-1,numOfPages:0,onPageChange:DC.NOOP,onPageScrollStart:DC.NOOP,onPageScroll:DC.NOOP,onPageScrollEnd:DC.NOOP,createChildren:function(){this.name="UIPageControl";this.addClass("UIPageControl");this.layoutClass=DC.GridLayout;this.itemRenderer=DC.UIPageRenderer;this.itemRendererOptions={width:this.innerWidth,height:this.innerHeight};this._super();this._scrollController.showScrollBar=false;},createComplete:function(){this._super();var self=this;this.addEventListener(DC.UIPageControlEvent.UNLOCK,function(e){self.handlePageControlUnlock(e);});this.addEventListener(DC.UIPageControlEvent.LOCK,function(e){self.handlePageControlLock(e);});this._scrollController.name="UIPageControl";this._scrollController.onScrollStart=function(){self.onPageScrollStart(self.currentPageIndex);};this._scrollController.onScrollEnd=function(x,y,isInScroll){if(!isInScroll){var p=-(x/self.innerWidth);self.handlePageChange(-(x/self.innerWidth));self.onPageScrollEnd(p);}};},invalidatelLayout:function(w,h){this._super(w,h);if(this._contentContainer){this._layout.rowCount=1;this._layout.columnWidth=this.innerWidth;this._layout.rowHeight=this.innerHeight;this._layout.numChildren=this._listController.length();this._layout.gap=0;this._scrollController.snap.x=this.innerWidth;this._scrollController.snap.y=this.innerHeight;}},buildChildren:function(ds){this._scrollController.lockScroll=false;this.updateChildren(0,3);},setSize:function(w,h){this._super(w,h);},handleScroll:function(x,y,s,t){this._super(x,y,s,t);this.onPageScroll(x,y,s,t);},handlePageControlUnlock:function(e){this._scrollController.lockScroll=false;},handlePageControlLock:function(e){this._scrollController.lockScroll=true;},handlePageChange:function(index){if(index!=this.currentPageIndex){if(this.datasource){this.currentPageIndex=index;var start=(index==0)?0:index-1;var length=(index==this.datasource-1)?2:3;this.updateChildren(start,length);for(var idx in this._contentContainer.children){var c=this._contentContainer.children[idx];if(c.data.index==index){this.currentPageView=c;c.setEnabled(true);}else{c.setEnabled(false);}c.setSize();}this._scrollController.lockScroll=false;if(this._listController.datasource.data){this.onPageChange(index,this._listController.datasource.data[index]);}}}},_scrollPageTo:function(index,t){if(this._scrollController){this._scrollController.manualScrollTo(-this.innerWidth*index,0,t);}},setCurrentPageIndex:function(index){if(this.currentPageIndex!=index){this._scrollPageTo(index,0);}},nextPage:function(){var index=this.currentPageIndex+1;if(index>=this.datasource.length()){index=this.datasource.length()-1;}this._scrollPageTo(index,0.4);},prevPage:function(){var index=this.currentPageIndex-1;if(index<0){index=0;}this._scrollPageTo(index,0.4);}};window.DC.UIPageControl=DC.ScrollListBase.extend(DC.UIPageControl);})(jQuery);jQuery.extend(jQuery.easing,{easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b;},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b;},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b;}return -c/2*((--t)*(t-2)-1)+b;},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b;},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b;}return c/2*((t-=2)*t*t+2)+b;},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b;},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b;},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b;}return -c/2*((t-=2)*t*t*t-2)+b;},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b;},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b;}return c/2*((t-=2)*t*t*t*t+2)+b;},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b;},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b;},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b;},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b;},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b;}if(t==d){return b+c;}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b;}return c/2*(-Math.pow(2,-10*--t)+2)+b;},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b;
},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b;},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b;}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b;},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b;}if((t/=d)==1){return b+c;}if(!p){p=d*0.3;}if(a<Math.abs(c)){a=c;var s=p/4;}else{var s=p/(2*Math.PI)*Math.asin(c/a);}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b;}if((t/=d)==1){return b+c;}if(!p){p=d*0.3;}if(a<Math.abs(c)){a=c;var s=p/4;}else{var s=p/(2*Math.PI)*Math.asin(c/a);}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b;}if((t/=d/2)==2){return b+c;}if(!p){p=d*(0.3*1.5);}if(a<Math.abs(c)){a=c;var s=p/4;}else{var s=p/(2*Math.PI)*Math.asin(c/a);}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b;},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158;}return c*(t/=d)*t*((s+1)*t-s)+b;},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158;}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158;}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b;},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b;}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b;}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return jQuery.easing.easeInBounce(x,t*2,0,c,d)*0.5+b;}return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b;}});(function($){DC.fullscreen=true;})(jQuery);